<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="hosts_detection">
    <title>Обнаружение узлов сети</title>
    <body>
        <p>DATAPK ITM-K может осуществлять автоматическое обнаружение <term
                keyref="monitoring_object">объектов мониторинга</term> путем сканирования диапазона
            IP-адресов, указанного в правилах сетевого обнаружения. Частота сканирования
            настраивается индивидуально каждому правилу.</p>
        <p>Одно правило обнаружения всегда обрабатывается одним процессом обнаружения. Диапазон IP
            адресов не разбивается между несколькими процессами обнаружения.</p>
        <p>Каждое правило имеет заданный набор проверок сервисов, которые будут выполняться по
            диапазону IP.</p>
        <p>Проверки обнаружения обрабатываются независимо от остальных проверок. Если какие-либо
            проверки не находят сервис (или завершаются с ошибкой), то другие проверки все равно
            выполняются.</p>
        <p>Каждая проверка сервиса и хоста (IP) выполняется модулем сетевого обнаружения, который
            порождает создание события обнаружения.</p>
        
        <table id="table_xfq_g2t_frb" frame="all" colsep="1" rowsep="1">
            <title>Типы событий обнаружения узлов сети и состояния сервисов</title>
            <tgroup cols="2">
                <colspec colnum="1" colname="col1"/>
                <colspec colnum="2" colname="col2"/>
                <thead>
                    <row>
                        <entry>Событие</entry>
                        <entry>Результат проверки сервиса</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>Сервис обнаружен</entry>
                        <entry>Сервис 'доступен' после того, как был 'недоступен' или когда
                            обнаружен первый раз.</entry>
                    </row>
                    <row>
                        <entry>Сервис доступен</entry>
                        <entry>Сервис 'доступен', подряд.</entry>
                    </row>
                    <row>
                        <entry>Сервис потерян</entry>
                        <entry>Сервис 'недоступен' после того, как был 'доступен'.</entry>
                    </row>
                    <row>
                        <entry>Сервис недоступен</entry>
                        <entry>Сервис 'недоступен', подряд.</entry>
                    </row>
                    <row>
                        <entry>Узел сети обнаружен</entry>
                        <entry>По крайней мере один сервис на узле сети 'доступен' после того, как
                            все сервисы на этом узле сети были 'недоступны'.</entry>
                    </row>
                    <row>
                        <entry>Узел сети доступен</entry>
                        <entry>По крайней мере один сервис на узле сети 'доступен', подряд.</entry>
                    </row>
                    <row>
                        <entry>Узел сети потерян</entry>
                        <entry>Все сервисы на узле сети 'недоступны' после того, как по крайней мере
                            один был 'доступен'.</entry>
                    </row>
                    <row>
                        <entry>Узел сети недоступен</entry>
                        <entry>Все сервисы на узле сети 'недоступны', подряд.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <p>События обнаружения могут быть основой соответствующих действий, таких как:</p>
        <ul id="ul_yfq_g2t_frb">
            <li>Отправка оповещений;</li>
            <li>Добавление/удаление узлов сети;</li>
            <li>Активация/деактивация узлов сети;</li>
            <li>Добавление узлов сети в группу;</li>
            <li>Удаление узлов сети из группы;</li>
            <li>Присоединение/отсоединение узлов сети к/от шаблона;</li>
            <li>Выполнение удаленных скриптов.</li>
        </ul>
        <p>Эти действия можно задать с учетом типа устройства, IP, состояния, времени
            доступности/недоступности и т.п. Настройка действий, которые будут выполняться в
            соответствии с каждым событием осуществляется на страницах <cite keyref="configuration">«Настройка»</cite> → <cite keyref="actions">«Действия»</cite>
            (выбрать подраздел «Действия обнаружения»).</p>
        <p><b>Создание интерфейсов при добавлении узлов сети</b></p>
        <p>Когда узлы сети добавляются в результате сетевого обнаружения, они получают интерфейсы,
            созданные в соответствии со следующими правилами:</p>
        <ul id="ul_zfq_g2t_frb">
            <li>обнаружены сервисы – например, если проверка SNMP прошла успешно, то будет создан
                SNMP интерфейс;</li>
            <li>если узел сети отвечает на запросы как DATAPK ITM-K агента, так и на запросы SNMP,
                будут созданы интерфейсы обоих типов;</li>
            <li>если критерием уникальности выступают данные с DATAPK ITM-K агента или с SNMP,
                первый найденный интерфейс, который будет создан для узла сети, будет интерфейсом по
                умолчанию. Другие IP адреса добавляются дополнительными интерфейсами;</li>
            <li>если узел сети отвечает только на проверки агентов, для него будет создан только
                агентский интерфейс. Если в дальнейшем он начнет отвечать на SNMP, дополнительно
                будет создан SNMP интерфейс;</li>
            <li>если были созданы 3 различных узла сети, будучи обнаруженными по критерию
                уникальности «IP», и затем правило обнаружения изменяется таким образом, что узлы
                сети A, B и C имеют одинаковый результат критерия уникальности, B и C будут созданы,
                как дополнительные интерфейсы к A (первому узлу сети). Узлы сети B и C останутся
                неизменными. В <cite keyref="monitoring">«Мониторинг</cite> → <cite keyref="detection">Обнаружение»</cite> добавленные интерфейсы будут отображаться
                в колонке <i>Обнаруженное устройство</i> черным шрифтом и с отступом, однако колонка
                    <i>Наблюдаемый узел сети</i> будет отображать только первый созданный узел сети
                A. <i>Доступен/Недоступен</i> не измеряется по отношению к IP адресам, которые
                считаются дополнительными интерфейсами.</li>
        </ul>
    </body>
</topic>
