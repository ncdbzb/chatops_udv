<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="snmp_monitoring">
    <title>Настройка мониторинга по SNMP</title>
    <taskbody><context>Для начала мониторинга устройства по SNMP должны быть выполнены следующие
        шаги:</context>
        <steps>
            <step>
                <cmd><b>Шаг 1.</b> Создайте узел сети для устройства с SNMP интерфейсом.</cmd>
                <substeps>
                    <substep>
                        <cmd>Введите IP адрес.</cmd>
                        <info>Можно использовать один из поставляемых шаблонов SNMP
                                (<codeph>Template SNMP Device</codeph> и другие), которые
                            автоматически добавят некоторый набор элементов данных. Тем не менее,
                            шаблон может быть не совместим с узлом сети.</info>
                    </substep>
                    <substep>
                        <cmd>Нажмите на «Добавить» для сохранения узла сети.</cmd>
                    </substep>
                </substeps>
            </step>
            <step>
                <cmd><b>Шаг 2.</b> Используйте строку SNMP (или OID) элемента данных, желаемую для
                    мониторинга.</cmd>
                <info>Для получения списка строк SNMP используется команда <codeph>snmpwalk</codeph>
                    (часть программного обеспечения net-snmp, которое должны устанавливается, как
                    часть инсталляции DATAPK ITM-K) или эквивалентную
                    утилиту:<codeblock id="codeblock_t1z_jjp_grb">shell> snmpwalk -v 2c -c public&lt;IP хоста></codeblock>'2c'
                    здесь означает версию SNMP, также можно заменить его на '1', чтобы использовать
                    1 версию SNMP на устройстве. Эта команда должна показать список SNMP строк и их
                    последние значения. Если это не произойдет, то возможно, что SNMP «community»
                    отличается от стандартного public, и в этом случае необходимо узнать это имя. </info>
                <info>Можно пройтись по списку, пока не найдется строка, желаемая для мониторинга.
                    Например, если необходимо мониторить входящее количество байт на коммутаторе на
                    3 порту, можно использовать <codeph>IF-MIB::ifInOctets.3</codeph> из этой
                    строки:<codeblock id="codeblock_u1z_jjp_grb">IF-MIB::ifInOctets.3 = Counter32:3409739121</codeblock>Можно
                    воспользоваться командой <codeph>snmpget</codeph> для того, чтобы определить
                    цифровой OID для
                    <codeph>'IF-MIB::ifInOctets.3'</codeph>:<codeblock id="codeblock_v1z_jjp_grb">shell> snmpget -v 2c -c public -On 10.62.1.22 IF-MIB::ifInOctets.3</codeblock>Обратите
                    внимание, что последнее число в строке – это номер порта, который используется
                    для мониторинга. Вывод команды покажет примерно
                    следующее:<codeblock id="codeblock_w1z_jjp_grb">.1.3.6.1.2.1.2.2.1.10.3 = Counter32:3472126941</codeblock>Последнее
                    число в OID является номером порта. 3COM, возможно, использует номера портов
                    сотнями, например: 1 порт = 101 порт, 3 порт = 103 порт. Но в Cisco используются
                    обычные номера, например, 3 порт =3. Некоторые из наиболее часто используемых
                    SNMP OID'ов автоматически конвертируются сервером DATAPK ITM-K в числовое
                    представление. В последнем примере выше тип – значение Counter32 (32-битный
                    счетчик), что внутренне соответствует типу ASN_COUNTER. Полный список
                    поддерживаемых типов: ASN_COUNTER, ASN_COUNTER64, ASN_UINTEGER, ASN_UNSIGNED64,
                    ASN_INTEGER, ASN_INTEGER64, ASN_FLOAT, ASN_DOUBLE, ASN_TIMETICKS, ASN_GAUGE,
                    ASN_IPADDRESS, ASN_OCTET_STR и ASN_OBJECT_ID (с 2.2.8, 2.4.3). Приведенные типы
                    грубо соответствуют Counter32, Counter64, UInteger32, INTEGER, Float, Double,
                    Timeticks, Gauge32, IpAddress, OCTET STRING, OBJECT IDENTIFIER в выводе утилиты
                        <codeph>snmpget</codeph>, но могут также отображаться как STRING,
                    Hex-STRING, OID и другие, в зависимости от наличия полученной подсказки. </info>
            </step>
            <step>
                <cmd><b>Шаг 3.</b> Создайте элемент данных для мониторинга.</cmd>
                <substeps>
                    <substep>
                        <cmd>Используя раздел в боковой панели <cite keyref="configuration"
                                >«Настройка»</cite> → <cite keyref="general">«Узлы сети»</cite>,
                            выберите созданный ранее узел сети SNMP.</cmd>
                        <info>В зависимости от того, использовался ли шаблон при создании узла сети
                            или нет, можно увидеть список элементов данных SNMP, связанных с
                            выбранным узлом сети, или окно нового элемента данных. </info>
                    </substep>
                    <substep>
                        <cmd>Исходя из предположения, что элемент данных создается самостоятельно с
                            помощью информации, которую только что собрали, используя команды
                                <codeph>snmpwalk</codeph> или <codeph>snmpget</codeph>, введите
                            простое описание на русском языке (или английском) в поле «Описание» в
                            диалоге нового элемента данных.</cmd>
                    </substep>
                    <substep>
                        <cmd>Убедитесь, что в поле «Узел сети» находится выбранный
                            коммутатор/роутер, и измените поле «Тип» в значение «SNMPv*
                            агент».</cmd>
                    </substep>
                    <substep>
                        <cmd>Введите «community» (обычно <i>public</i>) и указать текстовый или
                            числовой OID, который получили ранее в поле SNMP OID, например:
                            .1.3.6.1.2.1.2.2.1.10.3</cmd>
                    </substep>
                    <substep>
                        <cmd>Введите «Порт SNMP» (161) и «Ключ» (название, отображающее сведения о
                            получаемых данных, например, SNMP-InOctets-Bps).</cmd>
                    </substep>
                    <substep>
                        <cmd>Установите «Тип информации» в значение, равное «Числовой (с плавающей
                            точкой)» и шаг предобработки в секунду (это важно, т.к. противном случае
                            будут получаться накопленные значения с SNMP устройства вместо
                            последнего изменения).</cmd>
                    </substep>
                    <substep>
                        <cmd>Выберите множитель, если необходимо, и укажите параметры «Интервал
                            обновления» и «Хранение истории», если есть желание, чтобы значения
                            параметров отличались от установленных по умолчанию.</cmd>
                        <info>Все обязательные поля ввода отмечены красной звездочкой.</info>
                    </substep>
                    <substep>
                        <cmd>Сохраните элемент данных и перейдите в раздел боковой панели <cite
                                keyref="monitoring">«Мониторинг»</cite> → <cite keyref="latest_data"
                                >«Последние данные»</cite>, чтобы увидеть данные SNMP.</cmd>
                        <info>Обратите внимание на специфичные опции, доступные только для элементов
                            данных SNMPv3 <table id="table_xdp_twt_frb" frame="all" colsep="1"
                                rowsep="1">
                                <title>Параметры для элементов данных SNMPv3</title>
                                <tgroup cols="2">
                                    <colspec colnum="1" colname="col1" colwidth="1*"/>
                                    <colspec colnum="2" colname="col2" colwidth="1.86*"/>
                                    <thead>
                                        <row>
                                            <entry>Параметр</entry>
                                            <entry>Описание</entry>
                                        </row>
                                    </thead>
                                    <tbody>
                                        <row>
                                            <entry>Имя контекста</entry>
                                            <entry>
                                                <p>Контекстное имя для определения элемента данных в
                                                  SNMP подсети.</p>
                                                <p>Имя контекста поддерживается для SNMPv3.</p>
                                                <p>В данном поле раскрываются пользовательские
                                                  макросы.</p>
                                            </entry>
                                        </row>
                                        <row>
                                            <entry>Имя безопасности</entry>
                                            <entry>
                                                <p>Имя безопасности.</p>
                                                <p>В данном поле раскрываются пользовательские
                                                  макросы.</p>
                                            </entry>
                                        </row>
                                        <row>
                                            <entry>Уровень безопасности</entry>
                                            <entry>
                                                <p>Уровень безопасности:</p>
                                                <ul id="ul_lmp_nx3_jrb">
                                                  <li><b>noAuthNoPriv</b> - ни аутентификация, ни
                                                  протокол безопасности не используются;</li>
                                                  <li><b>AuthNoPriv</b> - используется протокол
                                                  аутентификации, протокол безопасности нет;</li>
                                                  <li><b>AuthPriv</b> - используются и протокол
                                                  аутентификации, и протокол безопасности.</li>
                                                </ul>
                                            </entry>
                                        </row>
                                        <row>
                                            <entry>Протокол аутентификации</entry>
                                            <entry>Выбирается протокол аутентификации - MD5 или
                                                SHA.</entry>
                                        </row>
                                        <row>
                                            <entry>Фраза-пароль аутентификации</entry>
                                            <entry>
                                                <p>Фраза-пароль для аутентификации.</p>
                                                <p>В данном поле раскрываются пользовательские
                                                  макросы.</p>
                                            </entry>
                                        </row>
                                        <row>
                                            <entry>Протокол безопасности</entry>
                                            <entry>Протокол безопасности - DES или AES.</entry>
                                        </row>
                                        <row>
                                            <entry>Фраза-пароль безопасности</entry>
                                            <entry>
                                                <p>Фраза-пароль безопасности.</p>
                                                <p>В данном поле раскрываются пользовательские
                                                  макросы.</p>
                                            </entry>
                                        </row>
                                    </tbody>
                                </tgroup>
                            </table><p>В случае некорректных учетных данных SNMPv3 (имя
                                безопасности, протокол/фраза-пароль аутентификации, протокол
                                безопасности) DATAPK ITM-K получит ошибку (сообщение ERROR) от
                                net-snmp, за исключением ошибочной фразы пароля безопасности – в
                                этом случае DATAPK ITM-K получит ошибку ВРЕМЯОЖИДАНИЯ от
                                net-snmp.</p><p>При изменениях в параметрах <b>Протокол
                                    аутентификации</b>, <b>Фраза-пароль аутентификации</b>,
                                    <b>Протокол безопасности</b> или <b>Фраза-пароль
                                    безопасности</b> необходимо перезапустить сервер/прокси, чтобы
                                эти изменения применились.</p>
                        </info>
                    </substep>
                </substeps>
            </step>
        </steps>
      
                            
                            
    </taskbody>
</task>
